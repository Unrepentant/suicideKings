/* skings - Script to parse data from the SuicideKings.lua from the 
 * World of Warcraft SuicideKings addon version 3.1
 * http://wow.curse.com/downloads/wow-addons/details/suicide-kings.aspx
 *  
 * Author: Rob G, aka Mottie (mottie.guildportal.com)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * v1.0 8/26/2010 Original version, posted to github
 */

(function($){$.fn.suicideKings=function(j){var i=$.extend({},$.fn.suicideKings.defaults,j);return this.each(function(){var g=$(this),h=$.meta?$.extend({},i,g.data()):i;$.ajax({url:h.skFile,success:function(a){a=a.replace(/\[(.*)\]\s\=\s/g,"$1:").replace(/[\t\r\n]/g,"").replace(/[\[\]]/g,"").replace(/\"\"\:\{\}\,/,"").replace(/--\s\d+/g,"").replace(/,\s\},\"/g,'],"').replace(/\{\{/g,"[{").replace(/,\}/g,"}").replace(/\}\}/g,"}]").replace(/,\s\}\]/g,"]}").replace(/Weapons\/Trinkets/,"wt").replace(/Tier\sList/,
"Tier").replace(/(\s\"|\"\s)/g,'"').replace(/class/g,"wowclass").replace(/SavedRollLists\s\=/,"");a=a.substring(0,a.lastIndexOf("SuicideKingsOptions"));a.lastIndexOf("SuicideKingsSyncKey")&&a.substring(0,a.lastIndexOf("SuicideKingsSyncKey"));a=$.parseJSON(a);var f=function(e){if(typeof e=="undefined")return["&nbsp;",""];return[e.player,typeof e.wowclass=="undefined"?h.fixClass[e.player]||"unknown":e.wowclass]},d="",b,c;for(c=0;c<h.ranksToShow;c++){d+='<tr><td class="rank">'+(c+1)+"</td>";b=f(a.wt[c]);
d+='<td class="wt '+b[1].toLowerCase()+'">'+b[0]+"</td>";b=f(a.Accessories[c]);d+='<td class="ac '+b[1].toLowerCase()+'">'+b[0]+"</td>";b=f(a.Armor[c]);d+='<td class="ar '+b[1].toLowerCase()+'">'+b[0]+"</td>";b=f(a.Tier[c]);d+='<td class="tl '+b[1].toLowerCase()+'">'+b[0]+"</td>"}g.find("tbody").append(d)},error:function(){g.html('<div align="center">No Data Found!</div>')}})})};$.fn.suicideKings.defaults={skFile:"SuicideKings.lua",ranksToShow:60,fixClass:[]}})(jQuery);
